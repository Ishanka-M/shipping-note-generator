<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shipping Note Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; padding: 40px; }
        .form-container { background: white; padding: 30px; max-width: 600px; margin: auto; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h2 { text-align: center; color: #1a73e8; margin-bottom: 25px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-weight: 600; margin-bottom: 5px; color: #444; }
        input, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        button { background: #1a73e8; color: white; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; width: 100%; margin-top: 10px; font-weight: bold; }
        button:hover { background: #1557b0; }

        /* PDF Styles - Hidden by default */
        #document-preview { 
            width: 210mm; padding: 15mm; background: white; 
            border: 1px solid #000; font-size: 11pt; color: black;
            display: none; /* පෙන්වන්නේ download කරන වෙලාවේදී පමණි */
        }
        .pdf-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .pdf-table td, .pdf-table th { border: 1px solid black; padding: 8px; vertical-align: top; }
        .header-title { text-align: center; font-size: 16pt; font-weight: bold; text-decoration: underline; margin-bottom: 20px; }
    </style>
</head>
<body>

<div class="form-container">
    <h2>Shipping Note Editor</h2>
    
    <div class="input-group">
        <label>1. a. Shipper (Name and Address)</label>
        <textarea id="shipper" rows="3">EFL GLOBAL FREEPORT (PVT) LTD LOT NO 117 SPUR ROAD 3 PHASE 1 </textarea>
    </div>

    <div class="input-group">
        <label>1. b. Consignee (Name and Address)</label>
        <textarea id="consignee" rows="3">POL-MET M.BLACHNIO SPÓLKA 05-462, UL.CICHA 46, ZANECIN, WIAZOWNA, POLAND [cite: 14, 16]</textarea>
    </div>

    <div class="input-group">
        <label>6. Vessel / Voyage</label>
        <input type="text" id="vessel" value="ONE READINESS / 009W [cite: 23, 27]">
    </div>

    <div class="input-group">
        <label>17. Description of Goods</label>
        <input type="text" id="goods" value="1X40 HC STC 55 PX OF SCREWS [cite: 48]">
    </div>

    <div class="input-group">
        <label>19 (a). Gross Wt (Kg)</label>
        <input type="text" id="weight" value="26,496.52 ">
    </div>

    <button onclick="generatePDF()">Download PDF</button>
</div>

<div id="document-preview">
    <div class="header-title">SHIPPING NOTE / BOAT NOTE - Exp 3a [cite: 1]</div>
    
    <table class="pdf-table">
        <tr>
            <td width="60%">
                <strong>1. a. Shipper:</strong><br>
                <div id="p-shipper"></div>
            </td>
            <td>
                <strong>10. SN (B/L) No:</strong><br> KTBE1E742102025 [cite: 6]
            </td>
        </tr>
        <tr>
            <td>
                <strong>1. b. Consignee:</strong><br>
                <div id="p-consignee"></div>
            </td>
            <td>
                <strong>13. Shipping Line:</strong><br> ONE LINE [cite: 15]
            </td>
        </tr>
        <tr>
            <td>
                <strong>6. Vessel:</strong> <span id="p-vessel"></span><br>
                <strong>Port of Loading:</strong> COLOMBO [cite: 28]
            </td>
            <td>
                <strong>Port of Discharge:</strong> HAMBURG, HH [cite: 32]<br>
                <strong>Place of Delivery:</strong> GDANSK [cite: 24]
            </td>
        </tr>
    </table>

    <table class="pdf-table" style="margin-top: 20px;">
        <tr style="background-color: #f2f2f2;">
            <th width="30%">15. Marks & Container No.</th>
            <th width="45%">17. Description of Goods</th>
            <th width="25%">19 (a). Gross Wt (Kg)</th>
        </tr>
        <tr>
            <td height="150">CMBF15124600 [cite: 7]</td>
            <td><div id="p-goods"></div></td>
            <td><div id="p-weight"></div></td>
        </tr>
    </table>

    <div style="margin-top: 30px;">
        <p><strong>31. Name of Declarant:</strong> Rizan-077 300 1241 [cite: 84]</p>
        <p><strong>Date:</strong> 03-Sep-25 [cite: 87]</p>
    </div>
</div>

<script>
    function generatePDF() {
        const element = document.getElementById('document-preview');
        
        // Form එකේ දත්ත PDF එකට දැමීම
        document.getElementById('p-shipper').innerText = document.getElementById('shipper').value;
        document.getElementById('p-consignee').innerText = document.getElementById('consignee').value;
        document.getElementById('p-vessel').innerText = document.getElementById('vessel').value;
        document.getElementById('p-goods').innerText = document.getElementById('goods').value;
        document.getElementById('p-weight').innerText = document.getElementById('weight').value;

        // PDF එක සැකසීමට පෙර Template එක පෙන්වීම
        element.style.display = 'block';

        const opt = {
            margin:       10,
            filename:     'Shipping_Note.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2, useCORS: true },
            jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };
        
        // PDF එක සාදා අවසන් වූ පසු නැවත සැඟවීම
        html2pdf().set(opt).from(element).save().then(() => {
            element.style.display = 'none';
        });
    }
</script>

</body>
</html>
